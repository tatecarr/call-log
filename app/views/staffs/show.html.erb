<% content_for :title, "Call Log: Staff" %>

<div style="float:left; width:448px; padding-bottom:10px;">
	
	<div class="show-page-name">
		<%=h @staff.first_name %> <%=h @staff.last_name %> (<%=h @staff.staff_id %>)
	</div>
	
	<div style="padding-left:15px;">
		
		<table>
			<% if @staff.org_level != 299 %>				
				<tr>
					<td style="padding-right:10px">
						<b>Include in reports?</b> <%= check_box_tag :include_in_reports, "report_checked", @staff.staff_info.include_in_reports %>
						<%= observe_field :include_in_reports, :url => { :action => :update_include_in_reports },
							:with => "'report_checked='+value+'&staff_id='+#{@staff.staff_id}"
						%>
					</td>
					<td>
						<div id="include_message">
							<% if @staff.staff_info.include_in_reports %>
								Staff included.
							<% else %>
								Staff not included.
							<% end %>
						</div>
					</td>
				</tr>
			<% end %>
			<tr>
				<td><b>Status:</b></td>
				<% if @staff.status.blank? %>
					<td>Unknown</td>
				<% else %>
					<td><%= @staff.status %></td>
				<% end %>
			</tr>
			<tr>
				<td><b>Email:</b></td>
				<% if @staff.email.blank? %>
					<td>None</td>
				<% else %>
					<td><%= @staff.email %></td>
				<% end %>
			</tr>
			<tr>
				<td><b>Work number:</b></td>
				<% if @staff.work_number.blank? %>
					<td>None</td>
				<% else %>
					<td><%= @staff.work_number %></td>
				<% end %>
			</tr>
			<tr>
				<td><b>Cell number:</b></td>
				<% if @staff.cell_number.blank? %>
					<td>None</td>
				<% else %>
					<td><%= @staff.cell_number %></td>
				<% end %>
			</tr>
			<tr>
				<td style="padding-right:10px"><b>Home number:</b></td>
				<% if @staff.home_number.blank? %>
					<td>None</td>
				<% else %>
					<td><%= @staff.home_number %></td>
				<% end %>
			</tr>
			<tr>
				<td><b>Address:</b></td>
				<td>
					<%=h @staff.address %> <br/>
					<%=h @staff.city %>, <%=h @staff.state %> <%=h @staff.zip %>
				</td>
			</tr>
			<tr>
				<td><b>Gender:</b></td>
				<% if @staff.gender.blank? %>
					<td>Unknown</td>
				<% else %>
					<td><%= @staff.gender %></td>
				<% end %>
			</tr>
			<tr>
				<td><b>DOH:</b></td>
				<% if @staff.doh.blank? %>
					<td>Unknown</td>
				<% else %>
					<td><%=h @staff.doh.strftime("%B %d, %Y") %></td>
				<% end %>
			</tr>
			<tr>
				<td><b>Payrate:</b></td>
				<% if @staff.payrate.blank? %>
					<td>Unknown</td>
				<% else %>
					<td>$<%= @staff.payrate %></td>
				<% end %>
			</tr>
		</table>
	</div>
</div>

<div style="float:left; width:450px; padding-top:33px; padding-bottom:10px;">
		
	<table>
		<tr>
			<td><b>Course:</b></td>
			<td><b>Expiration:</b></td>
		</tr>
		
		<% if @staff_courses.length == 0 %>
			<tr>
				<td colspan=2><%= @staff.first_name %> has not taken any courses.</td>
			</tr>
		<% else %>
			<% for course in @staff_courses do %>
				<% unless course.renewal_date.nil? %>
					<tr class="<% if course.renewal_date < Time.now && (course.name == "Adult CPR" || course.name == "First Aid" || course.name == "MAPS") %>expired<% end %><% if course.renewal_date >= Time.now and course.renewal_date < Time.now+1.month && (course.name == "Adult CPR" || course.name == "First Aid" || course.name == "MAPS") %>warning<% end %>">
						<td style="padding-right:10px;">
							<% if course.name.blank? %>
								Unknown
							<% else %>
								<%= course.name %>
							<% end %>
						</td>
						<td><%= course.renewal_date.strftime("%B %d, %Y") %></td>
					</tr>
				<% else %>
					<tr>
						<td style="padding-right:10px;">
							<% if course.name.blank? %>
								Unknown
							<% else %>
								<%= course.name %>
							<% end %>
						</td>
						<td>Unknown</td>
				<% end %>
			<% end %>
		<% end %>
	</table>
	
</div>
<br/>
<div style="float:left; width:880px; border-top:2px solid #CCC; padding-top:5px; padding-left:20px;">
	
	<div style="float:left; width:440px;">
		<p>
			<span id="experience_prefs"><b>Experience and Preferences: (Click to Edit)</b></span><br/>
		  	<%= in_place_editor_field :staff_info, 'experience_prefs', {}, {:rows => 10, :cols => 50, :external_control => "experience_prefs"} %>
		</p><br/>
		<p>
			<span id="skills_limits"><b>Skills and Limits: (Click to Edit)</b></span><br/>
		  	<%= in_place_editor_field :staff_info, 'skills_limits', {}, {:rows => 10, :cols => 50, :external_control => "skills_limits"} %>
		</p>
	</div>
	<div style="float:left; width:440px;">
		<p>
			<span id="schedule_availability"><b>Schedule and Availability: (Click to Edit)</b></span><br/>
		  	<%= in_place_editor_field :staff_info, 'schedule_availability', {}, {:rows => 10, :cols => 50, :external_control => "schedule_availability"} %>
		</p><br/>
		<p>
			<span id="contact_notes"><b>Contact Info and Notes: (Click to Edit)</b></span><br/>
		  	<%= in_place_editor_field :staff_info, 'contact_notes', {}, {:rows => 10, :cols => 50, :external_control => "contact_notes"} %>
		</p><br/>
	</div>

</div>